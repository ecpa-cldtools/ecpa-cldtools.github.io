class ClsMediaInspectorTool{#e="0.0.3";#t=[];#i=[];#r=[];constructor(){this.init()}init(){console.log("CldMediaInspectorTool Version",this.#e)}addMediaSrc(e){this.#t.push(e),void 0===this.#r||0===this.#r.length||this.#r.splice(0,this.#r.length),this.#r.push(e),this.addMediaRowData()}getErrorHints(e){var t="";return t+='<div class="matooltip"><span style="padding-right: 5px">&#9842;</span>',t+='<span class="matooltiptext">'+({404:"Check if the asset is available at the server or if the URL is accessible.",420:"Error encountered while processing the request - check it later again"}[e]||"Unknown error!")+"</span>",t+="</div>"}getThumbnail(){var e=`<img src=${this.#r[0].MediaPerf.name} style="width:100px">`,t=parseInt(this.#r[0].MediaRespHdr["content-length"])>0?e:'<img src="https://defaultplaceholder.png" width=100 height=100 />',i="",r=this.#r[0].MediaRespHdr["content-type"].split("/")[1],a=this.#r[0].MediaRespHdr["content-type"]||"";return void 0!==a&&(a.match(/^image\//i)?i+=t:a.match(/^video\//i)?i+=`\n<video width="300" controls>\n  <source src="${this.#r[0].MediaPerf.name}" type="${this.#r[0].MediaRespHdr["content-type"]}">\n  Your browser does not support the video tag.\n</video>`:a.match(/javascript/i)?i+='\n<span style="display: table;margin: 0 auto;color:lightgray;font-weight:bold;width: 60px;height: 50px;text-align: center;font-family: sans-serif;border-radius: 5px 5px 5px; border: 1px solid lightgray;float:left;">{ . . . }   JS</span>':i+=`\n<span style="display: table;margin: 0 auto;color:lightgray;font-weight:bold;width: 60px;height: 50px;text-align: center;font-family: sans-serif;border-radius: 5px 5px 5px; border: 1px solid lightgray;float:left;">{ - }   ${r.toUpperCase()}</span>`),i}getUrl(){var e="";return void 0!==(this.#r[0].MediaRespHdr["content-type"]||"")&&(e+=`<a style="word-wrap: break-word;" href=${this.#r[0].MediaPerf.name} target="_blank" >${this.#r[0].MediaPerf.name}</a>`),e}getRemoteIp(){return""}getFetchMethod(){return""}getEntitiesCount(){return"1"}getService(){return null!=this.#r[0].MediaRespHdr.server?this.#r[0].MediaRespHdr.server:this.#r[0].MediaRespHdr.hostname}getResponseStatus(){return parseInt(this.#r[0].MediaPerf.responseStatus)<1&&parseInt(this.#r[0].MediaRespHdr["content-length"])<1||this.#r[0].MediaRespHdr["error-message"].length>0?'<span style="color: red;">404</span>':(parseInt(this.#r[0].MediaPerf.responseStatus)||200).toString()}getHttpStatus(){return parseInt(this.#r[0].MediaPerf.responseStatus)<1&&parseInt(this.#r[0].MediaRespHdr["content-length"])<1||this.#r[0].MediaRespHdr["error-message"].length>0?"404":(parseInt(this.#r[0].MediaPerf.responseStatus)||200).toString()}getErrorMessage(){var e=this.#r[0].MediaRespHdr["error-message"];return`<span style="color: red;">${void 0===e||""===e?"":this.getErrorHints(this.getHttpStatus())+e}</span>`}getContentLength(){var e="",t=parseInt(this.#r[0].MediaRespHdr["content-length"])<1?"0 B":parseInt(this.#r[0].MediaRespHdr["content-length"]);return e+=isNaN(t)?"0 B":t+" B"}getScaleRatio(){var e="",t="No image to display";if(this.#r[0].MediaRespHdr["content-type"]?.match(/image|video/))if(void 0===this.#r[0].MediaDoc||0===this.#r[0].MediaDoc.naturalWidth||0===this.#r[0].MediaDoc.naturalHeight);else if(this.#r[0].MediaRespHdr["content-type"]?.match(/image/))t=(this.#r[0].MediaDoc.naturalWidth/this.#r[0].MediaDoc.clientWidth).toFixed(2)+":"+(this.#r[0].MediaDoc.naturalHeight/this.#r[0].MediaDoc.clientHeight).toFixed(2);else if(this.#r[0].MediaRespHdr["content-type"]?.match(/video/)){t=(this.#r[0].MediaDoc.videoWidth/this.#r[0].MediaDoc.clientWidth).toFixed(2)+":"+(this.#r[0].MediaDoc.videoHeight/this.#r[0].MediaDoc.clientHeight).toFixed(2)}return e+=t}getContentType(){var e="";let t="";if(""!==this.#r[0].MediaRespHdr["content-type"]){var i=this.#r[0].MediaRespHdr["content-type"].split("/"),r=i[0];r=r.charAt(0).toUpperCase()+r.substring(1);var a=i[1].split(";")[0];t=r+" "+("JAVASCRIPT"===(a=a.toUpperCase())?"JS":a)}return e+=t}getContentLength(){var e="",t=parseInt(this.#r[0].MediaRespHdr["content-length"]);if(isNaN(t))return"0 B";for(var i=0;t>=1024;)t/=1024,++i;return e+=(0==i?t:t.toFixed(2))+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][i]}getTtfb(){var e="",t=void 0===this.#r[0].MediaPerf?-1:this.#r[0].MediaPerf.responseStart-this.#r[0].MediaPerf.requestStart;return e+=t<0?"N/A":t.toFixed(2)+" ms"}getContentDownloadTime(){var e="",t=void 0===this.#r[0].MediaPerf?-1:this.#r[0].MediaPerf.responseEnd-this.#r[0].MediaPerf.responseStart;return e+=t<0?"N/A":t.toFixed(2)+" ms"}getProtocol(){var e="",t=this.#r[0].MediaRespHdr.protocol.replace(":","");return e+=("http/1.1"===this.#r[0].MediaPerf.nextHopProtocol?this.#r[0].MediaPerf.nextHopProtocol:this.#r[0].MediaPerf.nextHopProtocol.length>0?t+"/"+this.#r[0].MediaPerf.nextHopProtocol:t).toUpperCase()}getOriginalDimensions(){var e="";return this.#r[0].MediaDoc.naturalWidth>0&&this.#r[0].MediaDoc.naturalHeight>0&&(e+=this.#r[0].MediaDoc.naturalWidth+" x "+this.#r[0].MediaDoc.naturalHeight+"px",e+=" | Aspect Ratio - "+this.getAspectRatio(this.#r[0].MediaDoc.naturalWidth/this.#r[0].MediaDoc.naturalHeight,50).toString().replace(",",":")),e}getDisplayDimension(){var e="";this.#r[0].MediaDoc.naturalWidth>0&&this.#r[0].MediaDoc.naturalHeight>0&&(e+=this.#r[0].MediaDoc.clientWidth+" x "+this.#r[0].MediaDoc.clientHeight+"px",e+=" | Aspect Ratio - "+this.getAspectRatio(this.#r[0].MediaDoc.clientWidth/this.#r[0].MediaDoc.clientHeight,50).toString().replace(",",":"),e+=" | Scale Ratio: "+(this.#r[0].MediaDoc.naturalWidth/this.#r[0].MediaDoc.clientWidth).toFixed(2)+": "+(this.#r[0].MediaDoc.naturalHeight/this.#r[0].MediaDoc.clientHeight).toFixed(2),e+=" | DPR: "+this.#r[0].MediaRespHdr.dpr);return e}getServerTiming(){var e="";if(void 0!==this.#r[0].MediaRespHdr["server-timing"]){for(var t=this.#r[0].MediaRespHdr["server-timing"].split(","),i="",r=0;r<t.length;++r)for(var a=t[r].split(";"),n=0;n<a.length;++n){var s=a[n].split("=");void 0===s[1]?i.length>1?i+=`@Name: ${s[0]}, `:i+=`Name: ${s[0]}, `:i+=` ${s[0]}: ${s[1]},`}(i+"}").replace(",}","").split("@").forEach((t=>{e+=`${t.replace("Name: ","").replace(/,$/,"")}\n`}))}return e}getCldAssocInfo(){}getEtag(){return this.#r[0].MediaRespHdr.etag}getUserAgent(){return this.#r[0].MediaReqHdr["user-agent"]}getLastModified(){var e=this.#r[0].MediaRespHdr["last-modified"];return void 0===e||""===e?"":e}getResponseDate(){var e="";const t=new Date;return t.setTime(parseInt(this.#r[0].MediaPerf.perfTiming.responseEnd)),e+=t.toUTCString()}getCacheControl(){var e=this.#r[0].MediaRespHdr["cache-control"];return void 0===e||""===e?"":e}getLastServer(){var e=this.getService();if(void 0!==this.#r[0].MediaRespHdr["server-timing"]){for(var t=this.#r[0].MediaRespHdr["server-timing"].split(","),i="",r=0;r<t.length;++r)for(var a=t[r].split(";"),n=0;n<a.length;++n){var s=a[n].split("=");void 0===s[1]?i.length>1?i+=`@Name: ${s[0]}, `:i+=`Name: ${s[0]}, `:i+=` ${s[0]}: ${s[1]},`}var o=(i+"}").replace(",}","").split("@"),d=0;o.length>2&&(d=o.length-1);var l=e=o[d].split(",")[0].replace("Name: ","");const c=/cld-/gi,h=null==l.match(c)?0:1,p=/cloudinary/gi,g=null==l.match(p)?0:1;e=1==h||1==g?"Cloudinary":l}return e}getXContentTypeOption(){var e=this.#r[0].MediaRespHdr["x-content-type-options"];return void 0===e||""===e?"":e}getDetails(e){var t=`<button id="viewdetail${e}" class="collapsible btnactive${e}" style="width: 800px;">View</button>`;return t+=`<div class="mediadetail">\n      ${this.getDetailsPane(e)}\n    </div>`}getDetailRow(e,t){return`\n  <tr>\n    <td class="paramlabel"><span style="word-wrap: break-word;">${e}</span></td>\n    <td class="paramdesc"><div style="width: 450px;padding-left: 5px;"><span style="word-wrap: break-word;">${t}</span></div></td>\n  </tr>\n    `}getSummaryDetails(e){var t="<h5>Summary</h5>";return t+=`\n<div class="table-responsive">          \n  <table class="tableDetail">\n    <tbody>\n      ${this.getDetailRow("URL",this.getUrl())}\n      ${this.getDetailRow("Error Hints",this.getErrorHints(100))}\n      ${this.getDetailRow("HTTP Status",this.getProtocol()+"  "+this.getResponseStatus()+"\n"+this.getErrorMessage())}\n      ${this.getDetailRow("Original Dimensions",this.getOriginalDimensions())}\n      ${this.getDetailRow("Display Dimensions",this.getDisplayDimension())}\n      ${this.getDetailRow("Service",this.getLastServer())}\n      ${this.getDetailRow("Content-Type",this.getContentType())}\n      ${this.getDetailRow("Content-Length",this.getContentLength())}\n      ${this.getDetailRow("Server-Timing",this.getServerTiming())}\n      ${this.getDetailRow("eTag",this.getEtag())}\n      ${this.getDetailRow("TTFB",this.getTtfb())}\n      ${this.getDetailRow("Content Download",this.getContentDownloadTime())}\n      ${this.getDetailRow("Remote IP",this.getRemoteIp())}\n      ${this.getDetailRow("Method",this.getFetchMethod())}\n    </tbody>\n  </table>\n</div>\n    `}getAccessControlExposeHeaders(){return"Content-Length,ETag,Server-Timing,X-Content-Type-Options"}getRespHdrsDetails(e){var t="<h5>Response Headers</h5>";return t+=`\n<div class="table-responsive">          \n  <table class="tableDetail">\n    <tbody>\n      ${this.getDetailRow("Content-Type",this.getContentType())}\n      ${this.getDetailRow("eTag",this.getEtag())}\n      ${this.getDetailRow("Last Modified",this.getLastModified())}\n      ${this.getDetailRow("Date",this.getResponseDate())}\n      ${this.getDetailRow("Cache-Control",this.getCacheControl())}\n      ${this.getDetailRow("Server-Timing",this.getServerTiming())}\n      ${this.getDetailRow("Server",this.getLastServer())}\n      ${this.getDetailRow("X-Content-Type-Options",this.getXContentTypeOption())}\n      ${this.getDetailRow("Access-Control-Expose-Headers",this.getAccessControlExposeHeaders())}\n      ${this.getDetailRow("Accept-Ranges",this.getContentLength())}\n      ${this.getDetailRow("Timing-Allow-Origin","")}\n      ${this.getDetailRow("Access-Control-Allow-Origin","")}\n      ${this.getDetailRow("Accept-Ranges","")}\n    </tbody>\n  </table>\n</div>\n    `}getReqHdrsDetails(e){var t="<h5>Request Headers</h5>";return t+=`\n<div class="table-responsive">          \n  <table class="tableDetail">\n    <tbody>\n      ${this.getDetailRow("Sec-CH-UA",this.#r[0].MediaReqHdr["Sec-CH-UA"])}\n      ${this.getDetailRow("Sec-CH-UA-Mobile",this.#r[0].MediaReqHdr["Sec-CH-UA-Mobile"])}\n      ${this.getDetailRow("Sec-CH-UA-Platform",this.#r[0].MediaReqHdr["Sec-CH-UA-Platform"])}\n      ${this.getDetailRow("User-Agent",this.#r[0].MediaReqHdr["User-Agent"])}\n      ${this.getDetailRow("Upgrade-Insecure-Requests","")}\n      ${this.getDetailRow("Accept","")}\n      ${this.getDetailRow("Sec-Fetch-Site","")}\n      ${this.getDetailRow("Sec-Fetch-Mode","")}\n      ${this.getDetailRow("Sec-Fetch-User","")}\n      ${this.getDetailRow("Sec-Fetch-Dest","")}      \n    </tbody>\n  </table>\n</div>\n    `}getPerfDetails(e){var t="<h5>Performance</h5>";return t+=`\n<div class="table-responsive">          \n  <table class="tableDetail">\n    <tbody>\n    \n      ${this.getDetailRow("name",this.getUrl())}\n      ${this.getDetailRow("entryType",this.#r[0].MediaPerf.entryType)}\n      ${this.getDetailRow("startTime",this.#r[0].MediaPerf.startTime.toFixed(2)+" ms")}\n      ${this.getDetailRow("duration",this.#r[0].MediaPerf.duration.toFixed(2)+" ms")}\n      ${this.getDetailRow("initiatorType",this.#r[0].MediaPerf.initiatorType)}\n      ${this.getDetailRow("nextHopProtocol",this.#r[0].MediaPerf.nextHopProtocol)}\n      ${this.getDetailRow("renderBlockingStatus",this.#r[0].MediaPerf.renderBlockingStatus)}\n      ${this.getDetailRow("workerStart",this.#r[0].MediaPerf.workerStart)}\n      ${this.getDetailRow("redirectStart",this.#r[0].MediaPerf.perfTiming.redirectStart)}\n      ${this.getDetailRow("redirectEnd",this.#r[0].MediaPerf.perfTiming.redirectEnd)}\n      ${this.getDetailRow("fetchStart",this.#r[0].MediaPerf.perfTiming.fetchStart)}\n      ${this.getDetailRow("domainLookupStart",this.#r[0].MediaPerf.perfTiming.domainLookupStart)}\n      ${this.getDetailRow("domainLookupEnd",this.#r[0].MediaPerf.perfTiming.domainLookupEnd)}\n      ${this.getDetailRow("connectStart",this.#r[0].MediaPerf.connectStart.toFixed(2)+" ms")}\n      ${this.getDetailRow("connectEnd",this.#r[0].MediaPerf.connectEnd.toFixed(2)+" ms")}\n      ${this.getDetailRow("secureConnectionStart",this.#r[0].MediaPerf.secureConnectionStart.toFixed(2)+" ms")}\n      ${this.getDetailRow("requestStart",this.#r[0].MediaPerf.requestStart.toFixed(2)+" ms")}\n      ${this.getDetailRow("responseStart",this.#r[0].MediaPerf.responseStart.toFixed(2)+" ms")}\n      ${this.getDetailRow("responseEnd",this.#r[0].MediaPerf.responseEnd.toFixed(2)+" ms")}\n      ${this.getDetailRow("transferSize",this.#r[0].MediaPerf.transferSize)}\n      ${this.getDetailRow("encodedBodySize",this.#r[0].MediaPerf.encodedBodySize)}\n      ${this.getDetailRow("decodedBodySize",this.#r[0].MediaPerf.decodedBodySize)}\n      ${this.getDetailRow("responseStatus",this.getResponseStatus())}\n      ${this.getDetailRow("serverTiming",this.getServerTiming())}\n      ${this.getDetailRow("unloadEventStart",this.#r[0].MediaPerf.perfTiming.unloadEventStart)}\n      ${this.getDetailRow("unloadEventEnd",this.#r[0].MediaPerf.perfTiming.unloadEventEnd)}\n      ${this.getDetailRow("domInteractive",this.#r[0].MediaPerf.perfTiming.domInteractive)}\n      ${this.getDetailRow("domContentLoadedEventStart",this.#r[0].MediaPerf.perfTiming.domContentLoadedEventStart)}\n      ${this.getDetailRow("domContentLoadedEventEnd",this.#r[0].MediaPerf.perfTiming.domContentLoadedEventEnd)}\n      ${this.getDetailRow("domComplete",this.#r[0].MediaPerf.perfTiming.domComplete)}\n      ${this.getDetailRow("loadEventStart",this.#r[0].MediaPerf.perfTiming.loadEventStart)}\n      ${this.getDetailRow("loadEventEnd",this.#r[0].MediaPerf.perfTiming.loadEventEnd)}\n      ${this.getDetailRow("type","")}\n      ${this.getDetailRow("redirectCount","")}\n      ${this.getDetailRow("activationStart","")}\n\n    </tbody>\n  </table>\n</div>\n    `}getDetailsPane(e){return`\n      <div class="tab tab${e}">\n        <button class="tablinks tablinks${e}" onclick="showMediaDetails(${e}, event, 'Summary')" id="defaultOpen${e}">Summary</button>\n        <button class="tablinks tablinks${e}" onclick="showMediaDetails(${e}, event, 'ResponseHeaders')">Response Headers</button>\n        <button class="tablinks tablinks${e}" onclick="showMediaDetails(${e}, event, 'RequestHeaders')">Request Headers</button>\n        <button class="tablinks tablinks${e}" onclick="showMediaDetails(${e}, event, 'Performance')">Performance</button>\n        <button class="tablinks tablinks${e}" onclick="showMediaDetails(${e}, event, 'Transformation')">Transformation</button>\n        <button class="tablinks tablinks${e}" onclick="showMediaDetails(${e}, event, 'Utilities')">Utilities</button>\n      </div>\n      <div id="Summary${e}" class="tabcontent tabcontent${e}">\n      ${this.getSummaryDetails(e)}\n      </div>\n      <div id="ResponseHeaders${e}" class="tabcontent tabcontent${e}">\n      ${this.getRespHdrsDetails(e)}\n      </div>\n      <div id="RequestHeaders${e}" class="tabcontent tabcontent${e}">\n      ${this.getReqHdrsDetails(e)} \n      </div>\n      <div id="Performance${e}" class="tabcontent tabcontent${e} detailPane">\n      ${this.getPerfDetails(e)} \n      </div>\n      <div id="Transformation${e}" class="tabcontent tabcontent${e}">\n        <h5>Transformation</h5>\n        <p>Transformation is the capital of JapanA ${e}.</p>\n      </div>\n      <div id="Utilities${e}" class="tabcontent tabcontent${e}">\n        <h5>Utilities</h5>\n        <p>Utilities is the capital of Utilites ${e}.</p>\n      </div>  \n      `}getDivCellData(e,t="100px",i=!1){var r=`<div style="padding-left: 5px;width:${t}">`;return i&&(r+='<span style="word-wrap: break-word;">'),r+=e,i&&(r+="</span>"),r+="</div>"}addMediaRowData(){var e=[];e.push({style:'style="font-size: 14px;"',value:this.getDivCellData((this.#i.length+1).toString(),"10px")}),e.push({style:"",value:this.getDivCellData(this.getThumbnail(),"300px")}),e.push({style:'style="font-size: 14px;"',value:this.getDivCellData(this.getLastServer(),"150px",!0)}),e.push({style:'style="font-size: 14px;"',value:this.getDivCellData(this.getResponseStatus(),"30px")}),e.push({style:'style="font-size: 14px;"',value:this.getDivCellData(this.getErrorMessage(),"150px",!0)}),e.push({style:'style="font-size: 14px;"',value:this.getDivCellData(this.getUrl(),"250px",!0)}),e.push({style:'style="font-size: 14px;"',value:this.getDivCellData(this.getEntitiesCount(),"40px",!0)}),e.push({style:'style="font-size: 14px;"',value:this.getDivCellData(this.getScaleRatio())}),e.push({style:'style="font-size: 14px;"',value:this.getDivCellData(this.getContentType())}),e.push({style:'style="font-size: 14px;"',value:this.getDivCellData(this.getContentLength())}),e.push({style:'style="font-size: 14px;"',value:this.getDivCellData(this.getTtfb())}),e.push({style:'style="font-size: 14px;"',value:this.getDivCellData(this.getContentDownloadTime())}),e.push({style:'style="font-size: 14px;"',value:this.getDetails(this.#i.length)}),this.#i.push(e)}getTimestamp(){return(new Date).toISOString().replace(/-/g,"").replace(/:/g,"").replace(/\./,"")}getAspectRatio(e,t){for(var i=[0,1],r=[1,0];;){var a=[i[0]+r[0],i[1]+r[1]];if(e*a[1]>a[0]){if(t<a[1])return r;i=a}else{if(e*a[1]==a[0])return t>=a[1]?a:i[1]<r[1]?i:r;if(t<a[1])return i;r=a}}}createReportPage(e,t,i){const r=`<!DOCTYPE html>\n<html>\n<head>\n  <title>Cld Media Analyzer</title>\n  <meta charset="utf-8">\n  <meta name="viewport" content="width=device-width, initial-scale=1">\n  <link rel="stylesheet" type="text/css"\n      href="https://res.cloudinary.com/medialyzer/raw/upload/assets/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.css" />\n  <link rel="stylesheet" type="text/css" href="https://res.cloudinary.com/medialyzer/raw/upload/assets/datatables/1.13.4/css/dataTables.bootstrap4.min.css" />\n  <script src="https://res.cloudinary.com/medialyzer/raw/upload/assets/jquery/jquery-3.5.1.js"><\/script>\n  <script src="https://res.cloudinary.com/medialyzer/raw/upload/assets/datatables/1.13.4/js/jquery.dataTables.min.js"><\/script>\n  <script src="https://res.cloudinary.com/medialyzer/raw/upload/assets/datatables/1.13.4/js/dataTables.bootstrap4.min.js"><\/script>\n  <style>\n    .collapsible {\n      background-color: #777;\n      color: white;\n      cursor: pointer;\n      border: none;\n      font-size: 15px;\n      width: 100%;\n    }\n\n    .active, .collapsible:hover {\n      background-color: #555;\n    }  \n\n    .collapsible:after {\n      //content: '+';\n      color: white;\n      font-weight: bold;\n      float: right;\n      margin-left: 5px;\n    }\n\n    .mediadetail {      \n      max-height: 0;\n      overflow: hidden;\n      transition: max-height 0.2s ease-out;\n    }\n\n    /* ********** Style the tab */\n    .tab {\n      float: left;\n      border: 1px solid #ccc;\n      background-color: #f1f1f1;\n      width: 160px;\n      height: 600px;\n    }\n    \n    /* Style the buttons inside the tab */\n    .tab button {\n      display: block;\n      background-color: inherit;\n      color: black;\n      padding: 22px 16px;\n      width: 100%;\n      border: none;\n      outline: none;\n      text-align: left;\n      cursor: pointer;\n      transition: 0.3s;\n      font-size: 17px;\n      display: inline-flex;\n      align-items: center;\n      height: 22px;\n      font-size: 14px;\n    }\n    \n    /* Change background color of buttons on hover */\n    .tab button:hover {\n      background-color: #ddd;\n    }\n    \n    /* Create an active/current "tab button" class */\n    .tab button.active {\n      background-color: #ccc;\n    }\n    \n    /* Style the tab content */\n    .tabcontent {\n      float: left;\n      padding: 0px 12px;\n      border: 1px solid #ccc;\n      width: 640px;\n      border-left: none;\n      height: 600px;\n    }\n\n    .div.dataTables_wrapper {\n      width: 800px;\n      margin: 0 auto;\n    }\n\n    .tableDetail {\n      width: 95%;\n      background-color: rgb(11 191 29 / 11%);\n      font-size: 14px;\n      border: none;\n      white-space: pre-wrap;\n    }\n\n    .tableDetail .paramlabel {\n      width: 200px;\n      text-align: right;\n      font-weight: bold;\n      padding: .25rem;\n    }\n\n    .tableDetail .paramdesc {\n      word-wrap: break-word;\n      padding: .25rem;\n    }\n\n    div .detailPane {\n      overflow-x: hidden;\n      overflow-y: auto;\n      text-align:justify;\n    }\n\n    div .matooltip {\n      position: relative;\n      display: inline-block;\n      border-bottom: 1px dotted black;\n    }\n\n    div .matooltip .matooltiptext {\n      visibility: hidden;\n      width: 420px;\n      background-color: #1aa1f1;\n      color: #fff;\n      text-align: left;\n      border-radius: 6px;\n      padding-left: 5px;\n      font-size: 14px;\n    \n      /* Position the tooltip */\n      position: absolute;\n      z-index: 1;\n    }\n    \n    span .matooltiptext {\n      font-size: 12px;\n    }\n\n    div .matooltip:hover .matooltiptext {\n      visibility: visible;\n    }\n\n  </style>\n</head>\n<body>\n    <div class="mycontainer" style="padding-left: 20px;padding-right: 20px;padding-bottom: 50px;">\n      <h2>CLD Media Analyzer</h2>\n      <p>The list of images from the current page that are being analyzed.</p>  \n      <table id="example" class="table table-striped table-bordered" style="width:100%">\n          ${e}\n          ${t}\n          ${i}\n      </table>\n      <script>\n      $(document).ready(function () {\n        $('#example').DataTable({\n            scrollY: 600,\n            scrollX: true,\n            lengthMenu: [\n              [10, 25, 50, 100, -1],\n              [10, 25, 50, 100, 'All'],\n            ],\n            "pageLength": 50,\n        });\n    });\n      <\/script>\n    </div>\n    <script>\n      var coll = document.getElementsByClassName("collapsible");\n      var i;\n      for (i = 0; i < coll.length; i++) {\n        coll[i].addEventListener("click", function() {\n          this.classList.toggle("active");\n          var content = this.nextElementSibling;\n          if (content.style.maxHeight){\n            content.style.maxHeight = null;\n          } else {\n            content.style.maxHeight = content.scrollHeight + "px";\n          }\n        });\n      }\n    <\/script>\n\n    <script>\n      function showMediaDetails(tabClsIndex, evt, mediaDetail) {\n        var i, tabcontent, tablinks;\n        tabcontent = document.getElementsByClassName("tabcontent" + tabClsIndex.toString());\n        for (i = 0; i < tabcontent.length; i++) {\n          tabcontent[i].style.display = "none";\n        }\n        tablinks = document.getElementsByClassName("tablinks" + tabClsIndex.toString());\n        for (i = 0; i < tablinks.length; i++) {\n          tablinks[i].className = tablinks[i].className.replace(" active", "");\n        }\n        document.getElementById(mediaDetail + tabClsIndex.toString()).style.display = "block";\n        evt.currentTarget.className += " active";\n      }\n\n      var x = 0;\n      var rowItems = document.getElementsByClassName("collapsible");\n      for(x = 0; x < rowItems.length; x++)\n      {\n        document.getElementById("defaultOpen" + x.toString()).click();\n      }\n    <\/script>          \n</body>\n</html>\n      `,a=URL.createObjectURL(new Blob([r],{type:"text/html"}));this.getTimestamp(),window.open(a,"win"+this.getTimestamp(),"width=1500,height=1000,screenX=100,screenY=100")}show(){var e=new ClsMITTable;e.addHeaderFooter('<span style="font-size: 14px;width: 50px">Item</span>'),e.addHeaderFooter('<span style="font-size: 14px;width: 300px">Thumb</span>'),e.addHeaderFooter('<span style="font-size: 14px;width: 100px">Service</span>'),e.addHeaderFooter('<span style="font-size: 14px;width: 30px">Status</span>'),e.addHeaderFooter('<span style="font-size: 14px;">Error</span>'),e.addHeaderFooter('<span style="font-size: 14px;">URL</span>'),e.addHeaderFooter('<span style="font-size: 14px;">#</span>'),e.addHeaderFooter('<span style="font-size: 14px;">Scale Ratio</span>'),e.addHeaderFooter('<span style="font-size: 14px;">Content Type</span>'),e.addHeaderFooter('<span style="font-size: 14px;">Size</span>'),e.addHeaderFooter('<span style="font-size: 14px;">TTFB</span>'),e.addHeaderFooter('<span style="font-size: 14px;">Content Download</span>'),e.addHeaderFooter('<span style="font-size: 14px;">Details</span>'),this.#i.forEach((t=>{e.addRow(t)})),this.createReportPage(e.setHeader(),e.setRow(),e.setFooter())}}class ClsMediaSource{#a;#n;#s;#o;constructor(){}set MediaPerf(e){this.#a=e}get MediaPerf(){return this.#a}set MediaDoc(e){this.#n=e}get MediaDoc(){return this.#n}set MediaRespHdr(e){this.#s=e}get MediaRespHdr(){return this.#s}set MediaReqHdr(e){this.#o=e}get MediaReqHdr(){return this.#o}}class ClsMITTable{#d=0;#l=0;#c=0;#h=0;#p=[];#g=[];#u=[];constructor(){}addRow(e){var t="<tr>\n";e.forEach((e=>{t+=`<td ${e.style}>${e.value}</td>\n`})),t+="</tr>",this.#p.push(t),this.setRow(),this.#d++}addCol(e){this.#l++}addHeaderFooter(e){this.addHeader(e),this.addFooter(e)}addHeader(e){this.#g.push(`<th>${e}</th>`),this.setHeader(),this.#c++}addHeader(e,t){this.#g.push(`<th ${t}>${e}</th>`),this.setHeader(),this.#c++}addHeader(e,t,i){this.#g.push(`<th ${i} ${t}>${e}</th>`),this.setHeader(),this.#c++}addFooter(e){this.#u.push(`<th>${e}</th>`),this.setFooter(),this.#h++}setRow(){var e="<tbody>\n";return this.#p.forEach((t=>{e+=t+"\n"})),e+="</tbody>\n"}setHeader(){var e='<thead>\n<tr role="row">\n';return this.#g.forEach((t=>{e+=t+"\n"})),e+="</tr>\n</thead>"}setFooter(){var e="<tfoot>\n<tr>\n";return this.#g.forEach((t=>{e+=t+"\n"})),e+="</tr>\n</tfoot>"}}class ClsMediaInspectorUtil{constructor(){}getBrandsConcatenated=e=>e.map((e=>`"${this.escapeDoubleQuoteAndBackslash(e.brand)}";v="${e.version}"`)).join(", ");doubleQuoteEscape=e=>e.replace(/"/g,'\\"');backslashEscape=e=>e.replace(/\\/,"\\\\");escapeDoubleQuoteAndBackslash=e=>("string"==typeof e&&e&&(e=this.backslashEscape(e),e=this.doubleQuoteEscape(e)),e);isValidArray=e=>void 0!==e&&Array.isArray(e);getBrowserList=(e,t)=>this.isValidArray(e)?this.getBrandsConcatenated(e):this.isValidArray(t)?this.getBrandsConcatenated(t):void 0;getHintsValues=()=>["brands","mobile","platform","architecture","bitness","fullVersionList","model","platformVersion","wow64"];getPropertyQuoted(e){if(void 0!==e){return`"${this.escapeDoubleQuoteAndBackslash(e)}"`}return e}}function clientHintHeaders(){return clhder=new ClsMediaInspectorUtil,new Promise((e=>{const t=navigator&&navigator.userAgentData;t?t.getHighEntropyValues(clhder.getHintsValues()).then((t=>{const i={"User-Agent":navigator.userAgent,"Sec-CH-UA":clhder.getBrowserList(t.brands),"Sec-CH-UA-Arch":clhder.getPropertyQuoted(t.architecture),"Sec-CH-UA-Mobile":"?"+(t.mobile?"1":"0"),"Sec-CH-UA-Model":clhder.getPropertyQuoted(t.model),"Sec-CH-UA-Platform":clhder.getPropertyQuoted(t.platform),"Sec-CH-UA-Platform-Version":clhder.getPropertyQuoted(t.platformVersion),"Sec-CH-UA-Full-Version-List":clhder.getBrowserList(t.fullVersionList,t.brands),"Sec-CH-UA-Bitness":clhder.getPropertyQuoted(t.bitness),"Sec-CH-UA-Wow64":"?"+(t.wow64?"1":"0")};e(i)})):navigator?e({"User-Agent":navigator.userAgent}):e({})}))}function getResponseHeader(e){return new Promise((t=>{const i=[];var r=window.location.origin;i.push(e);const a=e=>e,n=e=>e.ok?Promise.resolve(e):Promise.reject(e);Promise.all(i.map((e=>fetch(e,{headers:{"Access-Control-Allow-Origin":r,"Access-Control-Allow-Headers":r,"Access-Control-Expose-Headers":"Content-Length,ETag,Server-Timing,X-Content-Type-Options"}}).then(n).then(a)))).then((e=>{t(e)})).catch((i=>{console.log("Encountered error while fetching head!",i);var r="";r=void 0===i.ok?i.toString():"Resource not found";var a=[],n=[],s={"content-type":"null/null",ok:!1,status:"404",statusText:"nok"};s.url=e,n.push(s),i.headers=n,i.errorMessage=r,a.push(i),console.log("Response",a),t(a)}))}))}function loadPerfData(){return new Promise((e=>{const t=()=>{performance.getEntriesByType("navigation")[0].duration?e("All loaded!"):setTimeout(t,10)};t()}))}async function asyncProcess(){console.log("Start asyncProcess");const e=await loadPerfData();console.log(e),console.log("Do all data gathering...");const t=new ClsMediaInspectorTool;let i=Array.from(window.document.querySelectorAll("*")),r=window.performance.getEntriesByType("resource").filter((e=>"img"==e.initiatorType||"video"==e.initiatorType)),a="";for(var n=0;n<i.length;++n){var s=i[n];if("IMG"===s.nodeName.toUpperCase()||"VIDEO"===s.nodeName.toUpperCase()){a="SCRIPT"===s.nodeName.toUpperCase()?s.src:s.currentSrc;let e=!1;var o=new ClsMediaSource;for(b=0;b<r.length;b++)a!==r[b].name||e||(e=!0,o.MediaDoc=s,r[b].perfTiming=window.performance.timing,o.MediaPerf=r[b]);if(!e&&""!=a){if((await getResponseHeader(a))[0].ok){let t=window.performance.getEntriesByType("resource").filter((e=>e.name==a));o.MediaDoc=s,t.length>0&&(t[0].perfTiming=window.performance.timing,o.MediaPerf=t[0],e=!0)}}if(e){const e=await getResponseHeader(a);var d={},l={},c="",h="",p="",g=!1,u="";if(e[0].ok){try{u=null==e[0].headers.get("etag")?"":e[0].headers.get("etag")}catch(e){u=""}for(var m of e[0].headers.entries())d[m[0]]=m[1]}else{for(var m of(console.log("respHdr.Nok",e),e[0].headers.entries()))d[m[0]]=m[1],"x-cld-error"===m[0]&&(c=m[0]+": "+m[1],g=!0);g||(c=e[0].errorMessage),d["content-type"]="*/html"}try{var f=new URL(a);h=f.hostname,p=f.protocol}catch(e){h="undefined"}d.protocol=p,d.hostname=h,d["error-message"]=c,d.dpr=window.devicePixelRatio.toFixed(0),d.etag=u,o.MediaRespHdr=d;var S=await clientHintHeaders();for(const[e,t]of Object.entries(S))l[`${e}`]=`${t}`;o.MediaReqHdr=l,t.addMediaSrc(o)}}}t.show(),console.log("window.navigator",window.navigator),console.log("window.performance",window.performance),console.log("window",window),console.log("objMiTool",t)}function appMain(){console.log("Start appMain"),asyncProcess()}appMain();
